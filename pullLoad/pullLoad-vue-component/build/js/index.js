function extend(t,e){return Object.assign(JSON.parse(JSON.stringify(t)),e)}function asArray(t,e){for(var n=[],o=e||0;o<t.length;o++)n.push(t[o]);return n}function bindAll(t,e,n){var o=0,s=t.length;for(void 0===n&&(n=e);o<s;o++){var i=t[o];"function"==typeof e[i]&&(e[i]=function(t,e){return function(){return t.apply(e,asArray(arguments,0))}}(e[i],n))}}function easing(t){var e=t,n=screen.availHeight;return n/2.5*Math.sin(e/n*(Math.PI/2))+0}var STATS={init:"",pulling:"pulling",enough:"pulling enough",refreshing:"refreshing",refreshed:"refreshed",reset:"reset",loading:"loading",nomore:"nomore"},extendFns=["onPullDownMove","onPullDownRefresh","clearPullDownMove","onPullUpMove","onPullUpLoad"],extendProps=["offsetScrollTop","offsetY","distanceBottom"],defaultConfig={tipText:{},offsetScrollTop:2,distanceBottom:100,container:null,wrapper:null,loaderBody:null,loaderSymbol:null,loaderBtn:null,downEnough:100,startX:0,startY:0,loaderState:STATS.init,hasMore:!0,dataList:null},pullLoad=Vue.extend({props:["options"],data:function(){return{pullupstyle:null,classchangevalue:""}},computed:{opts:function(){return extend(defaultConfig,this.options)}},template:'\n    <div class="tloader" :class="classchangevalue">\n        <div class="tloader-symbol">\n            <p class="tloader-msg"><i></i></p>\n            <p class="tloader-loading">\n            <i class="ui-loading"></i>\n            </p>\n        </div>\n        <div class="tloader-body" @touchstart="touchstartEvent" @touchmove="touchmoveEvent" @touchend="touchendEvent">\n            <ul class="test-ul">\n                <slot name="item" v-for="item in opts.dataList" :text="item">               \n                </slot>                       \n            </ul>\n        </div>\n        <div class="tloader-footer">\n            <p class="tloader-btn" :style="pullupstyle"></p>\n            <p class="tloader-loading">\n            <i class="ui-loading"></i>\n            </p>\n        </div>\n    </div>\n            ',methods:{touchstartEvent:function(t){this.onTouchStart(t)},touchmoveEvent:function(){this.onTouchMove(event)},touchendEvent:function(){this.onTouchEnd(event)},init:function(){var t=this.opts;this.container=t.container,this.wrapper=t.wrapper,bindAll(extendFns.concat(["onTouchStart","onTouchMove","onTouchEnd"]),this)},onMove:function(t,e,n,o,s){var i=t-this.startX,l=e-this.startY;Math.abs(l)>5&&Math.abs(l)>Math.abs(i)&&(l>5&&n<this.opts.offsetScrollTop?this.onPullDownMove(this.startY,e):l<0&&o-n-s<this.opts.distanceBottom&&(console.log("是否执行下拉动作。。。。"),this.onPullUpMove(this.startY,e)))},onEnd:function(t,e,n,o,s){var i=t-this.startX,l=e-this.startY;Math.abs(l)>5&&Math.abs(l)>Math.abs(i)&&(l>5&&n<this.opts.offsetScrollTop?this.onPullDownRefresh():l<0&&o-n-s<this.opts.distanceBottom?(console.log("是否执行上拉刷新动作"),this.onPullUpLoad()):this.clearPullDownMove())},destory:function(){},onTouchStart:function(t){var e=t.changedTouches[0],n=e.clientX,o=e.clientY;this.startX=n,this.startY=o},onTouchMove:function(t){var e=t.changedTouches[0],n=e.clientX,o=e.clientY,s=this.container.scrollTop,i=this.container.scrollHeight,l=this.container===document.body?document.documentElement.clientHeight:this.container.offsetHeight;this.onMove(n,o,s,i,l)},onTouchEnd:function(t){var e=t.changedTouches[0],n=e.clientX,o=e.clientY,s=this.container.scrollTop,i=this.container.scrollHeight,l=this.container===document.body?document.documentElement.clientHeight:this.container.offsetHeight;this.onEnd(n,o,s,i,l)},setChange:function(t,e){var n=0!==t?"translate3d(0, "+t+"px, 0)":"",o=t-50>0?t-50:0,s=0!==o?"translate3d(0, "+o+"px, 0)":"";this.setClassName(e),this.loaderBody=document.querySelectorAll(".tloader-body")[0],this.loaderSymbol=document.querySelectorAll(".tloader-symbol")[0],this.loaderBody.style.WebkitTransform=n,this.loaderBody.style.transform=n,this.loaderSymbol.style.WebkitTransform=s,this.loaderSymbol.style.transform=s},setClassName:function(t){this.loaderState=t;var e=""==t?"":"state-"+t;this.wrapper.className=""+e,this.classchangevalue=this.wrapper.className},setEndState:function(){this.setChange(0,STATS.reset)},setNoMoreState:function(){this.pullupstyle={display:"block"},this.opts.hasMore=!1},resetLoadMore:function(){this.pullupstyle={display:"none"},this.opts.hasMore=!0},onPullDownMove:function(t,e){if(this.loaderState===STATS.refreshing)return!1;event.preventDefault();var n,o=e-t;o<0&&(o=0),n=(o=easing(o))>this.opts.downEnough?STATS.enough:STATS.pulling,this.setChange(o,n)},onPullDownRefresh:function(){var t=this;if(this.loaderState===STATS.refreshing)return!1;this.loaderState===STATS.pulling?this.setEndState():(this.setChange(0,STATS.refreshing),this.resetLoadMore(),this.$emit("onpulldownrefresh",function(e){1==e?(t.setChange(0,STATS.refreshed),setTimeout(function(){t.setChange(0,STATS.init)},1e3)):(t.setChange(0,STATS.nomore),setTimeout(function(){t.setChange(0,STATS.init)},1e3))}))},clearPullDownMove:function(){},onPullUpMove:function(t,e){let n=this;if(!this.opts.hasMore||this.loaderState===STATS.loading)return!1;this.setChange(0,STATS.loading),this.$emit("onloadmore",function(t){n.setEndState(),t&&n.setNoMoreState()})},onPullUpLoad:function(){}},mounted:function(){this.$nextTick(function(){this.init()})}});Vue.component("pull-load",pullLoad);